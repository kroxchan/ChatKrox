# OpenClaw Cron 通道迁移经验（qqbot -> wecom）

背景：旧 cron 的 delivery 使用 `channel=qqbot`，现在要迁移到 `wecom`。

## 关键发现

1) `openclaw cron edit` 目前**无法只修改 delivery（--channel/--to）而不触碰 payload**。
   - 直接 `--channel wecom --to ...` 会报：`cron.update payload.kind="agentTurn" requires message`
   - 这是因为 edit 走的校验路径里，会把更新当成 agentTurn patch（或要求提供 message）。

2) 对 `sessionTarget=main` 的 job，payload 必须是 `systemEvent`。
   - 用 `--message` 会报：`main cron jobs require payload.kind="systemEvent"`

3) `openclaw cron edit` 的限制：`Choose at most one payload change`
   - 你不能在同一次 edit 里既改 payload（--system-event）又改 delivery（--channel/--to）。

## 可行迁移策略（推荐）

对需要迁移 delivery 的 main cron：

A) 用 `openclaw cron add` 重新创建一个等价 job，直接指定 wecom 投递：

- `openclaw cron add --name "<name>(wecom)" --cron "<expr>" --tz "Asia/Shanghai" --session main --wake <mode> --system-event "<text>" --channel wecom --to wecom:ChenZhengKang`

B) 确认新 job 出现在 `openclaw cron list` 中。

C) 删除旧 job：

- `openclaw cron rm <oldJobId>`

这样能绕过 edit 对 delivery patch 的限制。

## wecom 目录能力

当前 `openclaw directory self/peers` 对 `wecom` 不支持，因此无法通过 directory 查到更多 wecom 目标 id。
迁移其他人的定时任务前，需要用户提供对应 wecom 的 `--to` 目标字符串。

## 额外：彻底禁用 qqbot 插件

- 配置中移除 `channels.qqbot` / `plugins.entries.qqbot`（否则 config 可能 invalid）。
- 物理删除扩展目录：`C:\Users\Krox\.openclaw\extensions\qqbot*`
- 设置 `plugins.allow=["wecom"]`：CLI `config set` 不好用时，可直接改 `C:\Users\Krox\.openclaw\openclaw.json`：

```json
{
  "plugins": {
    "allow": ["wecom"]
  }
}
```

然后 `openclaw gateway restart`。
