# 2026-02-25

- 渠道切换：QQ 插件已不可用，后续与 ChenZhengKang 通过企业微信（WeCom）交互。
- 联系人映射：以 WeCom `sender_id` 为唯一标识；ChenZhengKang 为主联系人（本人）。
- 家人会话已出现：wecom:guancanghai / wecom:zb / wecom:xuyuanyouyizhangmenglian / wecom:wuyouping。
- 已确认：XuYuanYouYiZhangMengLian 为老婆（称呼偏好："老婆"）。
- 口头确认（待二次核实）：GuanCangHai 为爸爸。
- 已确认（来自 ChenZhengKang）：WuYouPing 为外婆（称呼：家家）；ZB 为妈妈。
- 隐私边界：家人对话内容无需同步给本人；仅在对应会话内回复。
- 工作准则（P0）：对 ChenZhengKang 的消息，必须先核实再回复（查日志/工具/文件），避免凭印象。
- Cron 迁移完成：30 个任务已从 qqbot 切换到 wecom，收件人映射为 WeCom sender_id（外婆=家家、妈妈=ZB、爸爸=GuanCangHai、老婆=XuYuanYouYiZhangMengLian、本人=ChenZhengKang）。
- Cron/WeCom 排障：`message send` 可达但 cron 投递多次不达，根因多为 job `delivery` 字段被清空/覆盖（`main + systemEvent` 版本经常丢失 delivery，`isolated + agentTurn + delivery.announce` 版本可稳定投递）。建议早安任务最终定型为 `isolated + agentTurn` 并保留 `delivery={mode:announce, channel:wecom, to:ChenZhengKang}`。
- Gateway/heartbeat 报错：日志持续出现 WeCom `errcode 81013 invaliduser:"heartbeat"`，来源为 `gateway/heartbeat` 子系统给无效收件人 heartbeat 发送导致；`openclaw.json` 的 `channels` 为空，需进一步定位配置来源。
- 早安最终定型（已实操）：将 job `54ca14c9-6858-46a3-9983-dfde22355589` 固定为 `sessionTarget=isolated` + `payload.kind=agentTurn` + `delivery={mode:announce, channel:wecom, to:ChenZhengKang}`，并保持 `schedule=0 9 * * *`（每天9点）。完成后重启 gateway 并 `cron run` 返回 `{ok:true, ran:true}`。
- 批量迁移异常：尝试脚本批量把所有 `delivery.channel=wecom && mode=announce` 的 cron 从 `main+systemEvent` 改为 `isolated+agentTurn`，但写回 `C:\Users\Krox\.openclaw\cron\jobs.json` 后读回未生效（例如 job `21a30a26-7a2c-43e5-b993-ba015e6ad9a4` 仍为 `main/systemEvent`）。推测存在另一个 store/state 或进程覆盖，需要定位真实生效来源；短期策略为“逐条改 + 立刻 cron run 验收”。
